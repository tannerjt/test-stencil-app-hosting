import{r as t,c as i,h as e,H as n,g as a}from"./p-a7bcab11.js";import{f as c,n as r,w as s}from"./p-b71772f1.js";import"./p-3b3bc7ac.js";import"./p-267d48f6.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */function o(t,i){const e="down"===i?"nextElementSibling":"previousElementSibling";let n=t,a=null;for(;n?.matches("calcite-tree-item");){if(!n.disabled){a=n;break}n=n[e]}return a}let l=class{constructor(e){t(this,e),this.calciteTreeSelect=i(this,"calciteTreeSelect",6),this.lines=!1,this.child=void 0,this.scale="m",this.selectionMode="single",this.selectedItems=[]}componentWillRender(){var t;const i=null===(t=this.el.parentElement)||void 0===t?void 0:t.closest("calcite-tree");this.lines=i?i.lines:this.lines,this.scale=i?i.scale:this.scale,this.selectionMode=i?i.selectionMode:this.selectionMode,this.child=!!i}render(){return e(n,{"aria-multiselectable":this.child?void 0:("multiple"===this.selectionMode||"multichildren"===this.selectionMode).toString(),role:this.child?void 0:"tree",tabIndex:this.getRootTabIndex()},e("slot",null))}onFocus(){if(!this.child){const t=this.el.querySelector("calcite-tree-item[selected]:not([disabled])")||this.el.querySelector("calcite-tree-item:not([disabled])");c(t)}}onFocusIn(t){(t.relatedTarget===this.el||!this.el.contains(t.relatedTarget))&&this.el.removeAttribute("tabindex")}onFocusOut(t){!this.el.contains(t.relatedTarget)&&(this.el.tabIndex=this.getRootTabIndex())}onClick(t){const i=t.target,e=r(i.querySelectorAll("calcite-tree-item"));if(this.child)return;if(this.child||(t.preventDefault(),t.stopPropagation()),"ancestors"===this.selectionMode&&!this.child)return void this.updateAncestorTree(t);const n="none"===this.selectionMode,a=!n&&t.detail.modifyCurrentSelection&&("multiple"===this.selectionMode||"multichildren"===this.selectionMode),c="multichildren"===this.selectionMode||"children"===this.selectionMode,s=!a&&(("single"===this.selectionMode||"multiple"===this.selectionMode)&&e.length<=0||"children"===this.selectionMode||"multichildren"===this.selectionMode),o="children"===this.selectionMode||"multichildren"===this.selectionMode;if(!this.child){const l=[];null!==this.selectionMode&&(!i.hasChildren||i.hasChildren&&("children"===this.selectionMode||"multichildren"===this.selectionMode))&&l.push(i),c&&e.forEach((t=>{l.push(t)})),s&&r(this.el.querySelectorAll("calcite-tree-item[selected]")).forEach((t=>{l.includes(t)||(t.selected=!1)})),o&&!t.detail.forceToggle&&(i.expanded=!0),a&&window.getSelection().removeAllRanges(),a&&i.selected||c&&t.detail.forceToggle?l.forEach((t=>{t.disabled||(t.selected=!1)})):n||l.forEach((t=>{t.disabled||(t.selected=!0)}))}this.selectedItems=n?[i]:r(this.el.querySelectorAll("calcite-tree-item")).filter((t=>t.selected)),this.calciteTreeSelect.emit(),t.stopPropagation()}keyDownHandler(t){var i;const e=this.el.closest("calcite-tree:not([child])"),n=t.target;if(e===this.el&&"CALCITE-TREE-ITEM"===n.tagName&&this.el.contains(n))if("ArrowDown"!==t.key){if("ArrowUp"===t.key){const i=o(n.previousElementSibling,"up");i&&(i.focus(),t.preventDefault())}if("ArrowLeft"===t.key&&!n.disabled){if(n.hasChildren&&n.expanded)return n.expanded=!1,void t.preventDefault();const i=n.parentElement.closest("calcite-tree-item");return!i||n.hasChildren&&!1!==n.expanded?void 0:(i.focus(),void t.preventDefault())}"ArrowRight"!==t.key||n.disabled||n.hasChildren&&(n.expanded&&s(this.el).activeElement===n?(null===(i=o(n.querySelector("calcite-tree-item"),"down"))||void 0===i||i.focus(),t.preventDefault()):(n.expanded=!0,t.preventDefault()))}else{const i=o(n.nextElementSibling,"down");i&&(i.focus(),t.preventDefault())}}updateAncestorTree(t){const i=t.target;if(i.disabled)return;const e=[];let n=i.parentElement.closest("calcite-tree-item");for(;n;)e.push(n),n=n.parentElement.closest("calcite-tree-item");const a=Array.from(i.querySelectorAll("calcite-tree-item:not([disabled])")),c=a.filter((t=>!t.hasChildren)),s=a.filter((t=>t.hasChildren)),o=i.hasChildren?!(i.selected||i.indeterminate):!i.selected;function l(t,i){const e=t.filter((t=>t.selected)),n=t.filter((t=>!t.selected));i.selected=e.length===t.length,i.indeterminate=e.length>0&&n.length>0}c.forEach((t=>{t.selected=o,t.indeterminate=!1})),s.forEach((t=>{l(Array.from(t.querySelectorAll(":scope > calcite-tree > calcite-tree-item")),t)})),i.hasChildren?l(a,i):(i.selected=o,i.indeterminate=!1),e.forEach((t=>{const i=r(t.querySelectorAll("calcite-tree-item")),e=i.filter((t=>t.selected));if(0===e.length)return t.selected=!1,void(t.indeterminate=!1);const n=e.length<i.length;t.indeterminate=n,t.selected=!n})),this.selectedItems=r(this.el.querySelectorAll("calcite-tree-item")).filter((t=>t.selected)),this.calciteTreeSelect.emit()}getRootTabIndex(){return this.child?-1:0}get el(){return a(this)}};l.style="@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}";export{l as calcite_tree}